
CC=gcc
CFLAGS=-c -O2 -Wall -std=c99 -D__EXTENSIONS__ -D_REENTRANT
LDFLAGS=-lm -lpthread

SOURCES=main.c sync_common.c
SOURCES_GLOBAL=$(SOURCES) list_global.c
SOURCES_LOCAL=$(SOURCES) list_local.c
SOURCES_DELAY=$(SOURCES) list_delay.c
SOURCES_GLOBAL_RW=$(SOURCES) list_global_rw.c
SOURCES_DELAY_RW=$(SOURCES) list_delay_rw.c

OBJECTS_GLOBAL=$(SOURCES_GLOBAL:.c=.o)
OBJECTS_LOCAL=$(SOURCES_LOCAL:.c=.o)
OBJECTS_DELAY=$(SOURCES_DELAY:.c=.o)
OBJECTS_GLOBAL_RW=$(SOURCES_GLOBAL_RW:.c=.o)
OBJECTS_DELAY_RW=$(SOURCES_DELAY_RW:.c=.o)

EXECUTABLE_GLOBAL=lab_global
EXECUTABLE_LOCAL=lab_local
EXECUTABLE_DELAY=lab_delay
EXECUTABLE_GLOBAL_RW=lab_global_rw
EXECUTABLE_DELAY_RW=lab_delay_rw

all: global local delay global_rw delay_rw

global: $(SOURCES_GLOBAL) $(EXECUTABLE_GLOBAL)

local: $(SOURCES_LOCAL) $(EXECUTABLE_LOCAL)

delay: $(SOURCES_DELAY) $(EXECUTABLE_DELAY)

global_rw: $(SOURCES_GLOBAL_RW) $(EXECUTABLE_GLOBAL_RW)

delay_rw: $(SOURCES_DELAY_RW) $(EXECUTABLE_DELAY_RW)

$(EXECUTABLE_GLOBAL): $(OBJECTS_GLOBAL)
	$(CC) $(LDFLAGS) $(OBJECTS_GLOBAL) -o $@

$(EXECUTABLE_LOCAL): $(OBJECTS_LOCAL)
	$(CC) $(LDFLAGS) $(OBJECTS_LOCAL) -o $@

$(EXECUTABLE_DELAY): $(OBJECTS_DELAY)
	$(CC) $(LDFLAGS) $(OBJECTS_DELAY) -o $@

$(EXECUTABLE_GLOBAL_RW): $(OBJECTS_GLOBAL_RW)
	$(CC) $(LDFLAGS) $(OBJECTS_GLOBAL_RW) -o $@

$(EXECUTABLE_DELAY_RW): $(OBJECTS_DELAY_RW)
	$(CC) $(LDFLAGS) $(OBJECTS_DELAY_RW) -o $@

.c.o:
	$(CC) $(CFLAGS) $< -o $@

clean:
	rm -f $(OBJECTS_GLOBAL) $(OBJECTS_LOCAL) $(OBJECTS_DELAY) $(OBJECTS_GLOBAL_RW) $(OBJECTS_DELAY_RW)
	rm -f $(EXECUTABLE_GLOBAL) $(EXECUTABLE_LOCAL) $(EXECUTABLE_DELAY) $(EXECUTABLE_GLOBAL_RW) $(EXECUTABLE_DELAY_RW)

clear: clean

rebuild: clean all

